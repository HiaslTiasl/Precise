<div class="modal-header">
	<h3 class="modal-title">New Task</h3>
</div>
<div class="modal-body">
	<div class="form-horizontal">
		<div class="form-group">
			<label for="phase" class="col-sm-4 control-label">Phase</label>
			<div class="col-sm-6">
				<select
					id="phase"
					class="form-control"
					ng-model="$ctrl.phase"
					ng-options="phase as phase.name for phase in $ctrl.phases track by phase.name"
					ng-change="$ctrl.phaseChanged()">
					<option value="">-- Select a phase --</option>
				</select>
			</div>
		</div>
		<div class="form-group mandatory">
			<label for="activity" class="col-sm-4 control-label">Activity</label>
			<div class="col-sm-6">
				<select
					id="activity"
					class="form-control"
					ng-model="$ctrl.resource.data.activity"
					ng-options="a as (a.shortName + ' - ' + a.name) for a in $ctrl.activities track by a.name"
					ng-change="$ctrl.activityChanged()"
					ng-disabled="!$ctrl.activities">
					<option value="">-- Select an activity --</option>
				</select>
			</div>
			<div class="col-sm-2 text-right">
				<button class="btn btn-default" ng-click="$ctrl.createActivity()">
					<span class="glyphicon glyphicon-plus"></span> New
				</button>
			</div>
		</div>
		<div class="form-group" ng-show="$ctrl.resource.data.activity.craft">
			<label for="craft" class="col-sm-4 control-label">Craft</label>
			<div class="col-sm-8">
				<p id="craft" class="form-control-static">{{$ctrl.resource.data.activity.craft | withShortName }}</p>
			</div>
		</div>
		<fieldset ng-show="$ctrl.resource.data.activity">
			<legend>Pitch</legend>
			<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
				<label for="man-hours" class="col-sm-4 control-label">Work amount</label>
				<div class="col-sm-4">
					<p id="duration-hours" class="form-control-static">
						<span ng-show="$ctrl.resource.data.manHours">
							{{$ctrl.resource.data.manHours}} man-hours
						</span>
						<span ng-show="!$ctrl.resource.data.manHours">
							N/A
						</span>
					</p>
				</div>
				<div class="col-sm-4 text-right">
					<button class="btn btn-default " ng-click="$ctrl.computePitches()">Compute</button>
				</div>
				<div class="col-sm-offset-4 col-sm-8">
					<span class="help-block" ng-show="$ctrl.pitchError">
						{{$ctrl.pitchError}}
					</span>
				</div>
			</div>
			<hr/>
			<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
				<label for="duration" class="col-sm-4 control-label">Expected duration</label>
				<div class="col-sm-8">
					<div class="input-group">
						<input id="duration"
							type="number"
							class="form-control"
							ng-model="$ctrl.resource.data.pitch.durationDays"/>
						<span class="input-group-addon">days</span>
					</div>
				</div>
			</div>
			<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
				<label for="crew-size" class="col-sm-4 control-label">Crew Size</label>
				<div class="col-sm-8">
					<input id="crew-size"
						type="number"
						class="form-control field-crew-size"
						ng-model="$ctrl.resource.data.pitch.crewSize"/>
				</div>
			</div>
			<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
				<label for="crew-count" class="col-sm-4 control-label">Crew Count</label>
				<div class="col-sm-8">
					<input id="crew-count"
						type="number"
						class="form-control field-crewCount"
						ng-model="$ctrl.resource.data.pitch.crewCount"/>
				</div>
			</div>
			<div ng-if="$ctrl.resource.data.activity.unitOfMeasure">
				<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
					<label for="quantity-per-day" class="col-sm-4 control-label">Crew Productivity</label>
					<div class="col-sm-8">
						<div class="input-group">
							<input id="quantity-per-day"
								type="number"
								step="0.1"
								class="form-control field-quantity-per-day"
								ng-model="$ctrl.resource.data.pitch.quantityPerDay"/>
							<span class="input-group-addon">{{$ctrl.resource.data.activity.unitOfMeasure}}/day</span>
						</div>
					</div>
				</div>
				<div class="form-group" ng-class="{'has-warning': $ctrl.pitchError}">
					<label for="total-quantity" class="col-sm-4 control-label">Total Quantity</label>
					<div class="col-sm-8">
						<div class="input-group">
							<input id="total-quantity"
								type="number"
								class="form-control field-total-quantity"
								ng-model="$ctrl.resource.data.pitch.totalQuantity"/>
							<span class="input-group-addon">{{$ctrl.resource.data.activity.unitOfMeasure}}</span>
						</div>
					</div>
				</div>
			</div>
		</fieldset>
	</div>
</div>
<div class="modal-footer">
	<button class="btn btn-primary" type="button" ng-click="$ctrl.send()" ng-disabled="!$ctrl.resource.data.activity">Done</button>
	<button class="btn btn-cancel" type="button" ng-click="$ctrl.cancel()">Cancel</button>
</div>