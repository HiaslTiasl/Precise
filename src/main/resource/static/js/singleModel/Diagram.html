<div class="panels">
	<!-- The DiagramPaper itself -->
	<!-- reload the model on structural changes to refresh info about whether config and diagram are empty and editable -->
	<!-- reload the warnings on all changes to keep them up-to-date -->
	<precise-diagram-paper
		model="$ctrl.model"
		current-warning="$ctrl.currentWarning"
		on-structure-changed="$ctrl.reload()"		
		on-diagram-changed="$ctrl.loadWarnings()">
	</precise-diagram-paper>
	<div id="properties-wrapper" ng-show="$ctrl.resource" ng-switch on="$ctrl.resourceType">
		<task-properties
			class="properties"
			ng-switch-when="task"
			resource="$ctrl.resource"
			done="$ctrl.done($result)"
			cancelled="$ctrl.cancelled()"
			activity-changed="$ctrl.activityChanged($result)">
		</task-properties>
		<dependency-properties
			class="properties"
			ng-switch-when="dependency"
			resource="$ctrl.resource"
			done="$ctrl.done($result)"
			cancelled="$ctrl.cancelled()">
		</dependency-properties>
		<div ng-switch-default>
			Nothing selected.
		</div>
	</div>
</div>
<div id="warnings" class="panel panel-default">
	<header class="panel-heading" ng-click="$ctrl.warningsOpen = !$ctrl.warningsOpen">
		<a href>
			Warnings
			<span class="badge" ng-show="$ctrl.warnings.length">{{$ctrl.warnings.length}}</span>
			<span class="warnings-loader" ng-if="!$ctrl.warnings"></span>
		</a>
	</header>
	<article uib-collapse="!$ctrl.warningsOpen" class="{{$ctrl.warnings.length ? 'list-group' : 'panel-body'}}">
		<a href
			class="list-group-item"
			ng-if="$ctrl.warnings.length > 0"
			ng-class="{'list-group-item-danger': w === $ctrl.currentWarning}"
			ng-repeat="w in $ctrl.warnings track by $index"
			ng-click="$ctrl.showWarning(w)">
			{{w.message}}
		</a>
		<p class="text-muted" ng-if="$ctrl.warnings.length === 0">No warnings</p> 
		<p class="text-muted" ng-if="!$ctrl.warnings">Loading...</p>
	</article>
</div>
